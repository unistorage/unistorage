{% extends 'base.html' %}
{% set active_page = 'users' %}


{% block static %}
  {{ super() }}

  {% assets 'statistics_js' %}
    <script src="{{ ASSET_URL }}"></script>
  {% endassets %}
{% endblock %}


{% block content %}
  <h3>Статистика пользователя {{ user.name }}</h3>

  <form action="" method="GET" class="form-horizontal"> 
    <div class="control-group">
        <label class="control-label">Тип контента:</label>
    <div class="controls">
    <select name="type_id">
      <option></option>
      {% for type_id in type_ids %}
      <option value="{{ type_id }}" {% if request.args.type_id == type_id %}selected{% endif %}>
        {{ type_id }}
      </option>
      {% endfor %}
    </select>
    </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn">Показать</button>
    </div>
  </form>

  <dl class="dl-horizontal">
    <dt>Количество файлов</dt>
    <dd>{{ summary.files_count }}</dd>
    <dt>Объём файлов</dt>
    <dd>{{ summary.files_size }} МБ</dd>
  </dl>

  <script type="text/javascript">
      var filesCountData = [
          {% for entry in statistics -%}
              [{{ entry.timestamp.strftime('%s') }} * 1000, {{ entry.files_count }}],
          {%- endfor %}
      ];

      var filesSizeData = [
          {% for entry in statistics -%}
              [{{ entry.timestamp.strftime('%s') }} * 1000, {{ entry.files_size }}],
          {%- endfor %}
      ];
  </script>

  <div id="plot" style="width:100%;height:500px;"></div>
{% endblock %}
